---
import '../../styles/global.css';
import { bunnyImage } from '../../lib/bunny-cdn';
import C4CaseStudy from '../../components/sections/C4CaseStudy/C4CaseStudy.astro';
import FourColumnGrid from '../../components/sections/FourColumnGrid/FourColumnGrid.astro';
import AdidasHardenV9EventGrid from '../../components/sections/DerrickRoseBrandGrid/AdidasHardenV9EventGrid.astro';
import TwoBlockImageContent from '../../components/sections/TwoBlockGrid/TwoBlockImageContent.astro';
import HashScrollInit from '../../components/HashScrollInit.astro';
import Navigation from '../../components/Navigation.astro';

// RULE-021: WordPress URL auto-conversion to Bunny CDN
const fadeSectionBg = bunnyImage('/wp-content/uploads/2025/09/1dfd153532710783b47687564bb21be6d42a8065.jpg', {
	pullZone: 'wordpress',
	width: 1920,
	quality: 85
});

// Logo for final section (225px width)
const logoFinal = bunnyImage('/wp-content/uploads/2025/08/Times10-Logo-2025-2.png', {
	pullZone: 'wordpress',
	width: 225,
	quality: 85
});
---

<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/png" href="/favicon.png" />
		<meta name="viewport" content="width=device-width" />
		<meta name="generator" content={Astro.generator} />
		<title>Adidas Harden Vol. 9 - Case Study | times10</title>
	</head>
	<body class="font-sans overflow-x-hidden bg-[#fdfffd]">
		<script>
			// Global error handler to prevent jQuery errors from breaking the page
			// jQuery may be injected by browser extensions or dev tools
			(function() {
				// Catch unhandled errors (including jQuery selector errors)
				window.addEventListener('error', function(event) {
					// Check if it's the jQuery selector error
					if (event.message && (
						event.message.includes("is not a valid selector") ||
						event.message.includes("*,:x") ||
						event.filename && event.filename.includes('jquery')
					)) {
						// Prevent the error from breaking the page
						event.preventDefault();
						console.warn('[Error Handler] Caught jQuery selector error (likely from browser extension):', event.message);
						return false;
					}
				}, true); // Use capture phase to catch errors early

				// Also catch unhandled promise rejections
				window.addEventListener('unhandledrejection', function(event) {
					if (event.reason && (
						event.reason.message && event.reason.message.includes("is not a valid selector") ||
						event.reason.message && event.reason.message.includes("*,:x")
					)) {
						event.preventDefault();
						console.warn('[Error Handler] Caught jQuery promise rejection:', event.reason);
					}
				});
			})();
		</script>
	<Navigation />
		<script>
			// Development: Save and restore scroll position
			// Remove this in production by deleting the script or setting ENABLE_SCROLL_RESTORE=false
			(function() {
				const STORAGE_KEY = 'dev-scroll-section';
				
				function initScrollRestore() {
					// Skip scroll restore if there's a hash in the URL (hash-scroll handles it)
					if (window.location.hash) {
						return;
					}
					
					const sections = document.querySelectorAll('section[class*="snap-start"]');
					if (sections.length === 0) return;
					
					// Restore scroll position on load
					const savedIndex = sessionStorage.getItem(STORAGE_KEY);
					if (savedIndex !== null) {
						const index = parseInt(savedIndex, 10);
						if (index >= 0 && index < sections.length) {
							// Small delay to ensure layout is complete
							setTimeout(() => {
								sections[index].scrollIntoView({ behavior: 'instant' });
							}, 100);
						}
					}
					
					// Track current section using IntersectionObserver
					const observer = new IntersectionObserver((entries) => {
						entries.forEach((entry) => {
							if (entry.isIntersecting && entry.intersectionRatio > 0.5) {
								const index = Array.from(sections).indexOf(entry.target);
								if (index !== -1) {
									sessionStorage.setItem(STORAGE_KEY, index.toString());
								}
							}
						});
					}, {
						threshold: 0.5,
						rootMargin: '-20% 0px -20% 0px'
					});
					
					// Observe all sections
					sections.forEach((section) => observer.observe(section));
				}
				
				// Wait for DOM to be ready
				if (document.readyState === 'loading') {
					document.addEventListener('DOMContentLoaded', initScrollRestore);
				} else {
					initScrollRestore();
				}
			})();
		</script>
		<section 
			id="harden-vol9-case-study-title"
			class="w-full h-dvh snap-start snap-always bg-no-repeat flex items-center justify-center relative bg-black"
			style={`background-image: url('${fadeSectionBg}'); background-position: center bottom; background-size: cover;`}
		>
			<div 
				id="harden-vol9-case-study-title-overlay"
				class="absolute inset-0 bg-black transition-opacity duration-1000 ease-in-out"
			></div>
			<div class="absolute top-1/2 -translate-y-1/2 left-1/2 -translate-x-1/2 lg:top-[9em] lg:translate-y-0 z-10">
				<svg id="Layer_2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1897.16 291.98" class="w-screen h-auto" style="width: 100vw; height: auto;">
					<defs>
						<style>.cls-1{fill:#fff;}</style>
					</defs>
					<g id="Layer_1-2">
						<path class="cls-1" d="M58.23,4.25v111.78h42.93V4.25h58.23v283.48h-58.23v-121.98h-42.93v121.98H0V4.25h58.23Z"></path>
						<path class="cls-1" d="M292.82,4.25l64.18,283.48h-58.65l-11.48-61.2h-56.1l-11.05,61.2h-52.28L232.47,4.25h60.35ZM236.72,180.63h43.78l-15.73-75.65c-4.25-20.83-5.1-30.18-5.95-47.6-1.27,9.77-4.25,31.02-6.8,45.05l-15.3,78.2Z"></path>
						<path class="cls-1" d="M365.07,4.25h89.25c53.55,0,73.1,41.23,73.1,84.58,0,33.58-8.08,59.08-36.98,76.08l42.93,122.83h-61.2l-31.88-111.35h-18.28v111.35h-56.95V4.25ZM422.02,129.63h14.88c19.55,0,32.73-8.08,32.73-41.65,0-30.6-12.75-39.1-34-39.1h-13.6v80.75Z"></path>
						<path class="cls-1" d="M619.64,4.25c95.2,0,107.1,79.9,107.1,138.55,0,90.95-32.73,144.93-96.05,144.93h-79.48V4.25h68.43ZM608.17,238h17c10.63,0,19.98-2.55,25.93-7.65,12.33-10.2,14.03-50.15,14.03-83.3,0-62.48-5.95-93.5-36.13-93.5h-20.83v184.45Z"></path>
						<path class="cls-1" d="M899.29,4.25v49.73h-89.25v65.88h68.43v47.17h-68.43v70.98h89.25v49.73h-147.48V4.25h147.48Z"></path>
						<path class="cls-1" d="M973.23,4.25l43.78,123.68c2.55,7.23,8.5,25.93,15.73,62.05-3.4-47.6-4.25-71.83-4.25-83.73V4.25h47.18v283.48h-47.18l-53.13-144.93c-5.52-15.3-11.05-33.58-16.58-57.8,3.83,42.93,4.68,76.08,4.68,82.03v120.7h-47.18V4.25h56.95Z"></path>
						<path class="cls-1" d="M1206.55,4.25l21.68,130.05c2.98,18.7,7.65,55.68,10.62,83.73,1.7-22.53,4.68-50.58,10.2-82.45l23.38-131.33h50.15l-59.5,283.48h-59.08L1146.2,4.25h60.35Z"></path>
						<path class="cls-1" d="M1501.93,147.9c0,101.58-29.33,144.08-89.25,144.08-62.9,0-87.98-51.85-87.98-149.18S1354.45,0,1413.95,0s87.98,45.48,87.98,147.9ZM1413.95,241.4c22.53,0,26.35-15.73,26.35-96.05,0-70.98-2.97-94.78-27.62-94.78-26.35,0-26.35,44.63-26.35,98.18,0,64.18,2.97,92.65,27.62,92.65Z"></path>
						<path class="cls-1" d="M1585.22,4.25v231.2h71.83v52.28h-130.05V4.25h58.23Z"></path>
						<path class="cls-1" d="M1897.16,140.68c0,103.28-29.33,151.3-85.85,151.3-40.8,0-65.03-22.1-71.4-69.28l48.03-9.35c3.83,22.53,10.2,32.73,24.23,32.73,22.95,0,31.45-26.78,31.45-76.08,0-4.25-.42-9.35-.42-14.03-11.9,19.12-25.5,26.78-42.93,26.78-37.83,0-63.33-32.73-63.33-87.13,0-57.8,28.05-95.63,77.78-95.63,53.98,0,82.45,43.78,82.45,140.68ZM1815.56,136c17,0,25.93-14.02,25.93-45.05s-9.35-45.05-25.93-45.05c-19.12,0-24.65,17-24.65,45.48s5.95,44.63,24.65,44.63Z"></path>
					</g>
				</svg>
			</div>
		</section>
		<script>
			// Fade in/out black overlay when harden vol9 case study title section enters/exits viewport
			(function() {
				const overlay = document.getElementById('harden-vol9-case-study-title-overlay');
				if (!overlay) return;

				// Check for reduced motion preference
				const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
				
				// If reduced motion, hide overlay immediately
				if (prefersReducedMotion) {
					overlay.style.opacity = '0';
					return;
				}

				// Use Intersection Observer to trigger fade in/out
				const section = document.getElementById('harden-vol9-case-study-title');
				if (!section) return;

				const observer = new IntersectionObserver((entries) => {
					entries.forEach((entry) => {
						if (entry.isIntersecting) {
							// Fade out the black overlay to reveal background image
							overlay.style.opacity = '0';
						} else {
							// Fade in the black overlay when section exits viewport
							overlay.style.opacity = '1';
						}
					});
				}, {
					threshold: 0.1,
					rootMargin: '0px'
				});

				observer.observe(section);
			})();
		</script>
		<C4CaseStudy
			id="adidas-harden-vol"
			image={{
				src: '/wp-content/uploads/2025/09/03202025-Adidas-HardenV9Event-155.jpg',
				alt: 'Adidas Harden Vol. 9 launch event at adidas Melrose',
				pullZone: 'wordpress',
				width: 1200,
				quality: 85
			}}
			challenge="Create an unforgettable retail moment for the Harden Vol. 9 launch at adidas Melrose in March of 2025 that not only drives product sell-through but also cements the store as a cultural hotspot. We needed to capture the energy of James Harden's brand, build buzz ahead of release, deliver a premium in-store experience, and generate high-impact content that lived far beyond the event day."
			whatWeDid="Designed and executed a full Harden Vol. 9 takeover at adidas Melrose, featuring chrome-themed window installations, interactive zones, custom branded touch points, and an on-theme food activation with Marathon Burgers. Managed end-to-end fan and VIP experiences including James Harden's arrival, autograph/photo opportunities, influencer and media seeding, branded giveaways, and seamless guest flow with premium security. Delivered multi-channel communications and content through RSVP management, digital invites, pre-event hype, and professional photo/video capture for both immediate coverage and long-tail social distribution."
			keyInitiatives={[]}
		/>
		<FourColumnGrid
			id="four-column-grid"
			images={[
				{
					src: '/wp-content/uploads/2025/09/03202025-Adidas-HardenV9Event-112.jpg',
					alt: 'Adidas Harden Vol. 9 Event',
					pullZone: 'wordpress',
					priority: true,
					width: 1200,
					quality: 85
				},
				{
					src: '/wp-content/uploads/2025/09/03202025-Adidas-HardenV9Event-108.jpg',
					alt: 'Adidas Harden Vol. 9 Event',
					pullZone: 'wordpress',
					priority: true,
					width: 1200,
					quality: 85
				},
				{
					src: '/wp-content/uploads/2025/09/03202025-Adidas-HardenV9Event-191.jpg',
					alt: 'Adidas Harden Vol. 9 Event',
					pullZone: 'wordpress',
					priority: false,
					width: 1200,
					quality: 85
				},
				{
					src: '/wp-content/uploads/2025/09/2fe24f6f3737666e066a7d1bcdbf0d9782c22bb1.jpg',
					alt: 'Adidas Harden Vol. 9 Event',
					pullZone: 'wordpress',
					priority: false,
					width: 1200,
					quality: 85
				},
				{
					src: '/wp-content/uploads/2025/09/6d14ab69f3c888fcd52b7c840691d0624704ff62.jpg',
					alt: 'Adidas Harden Vol. 9 Event',
					pullZone: 'wordpress',
					priority: false,
					width: 1200,
					quality: 85
				},
				{
					src: '/wp-content/uploads/2025/09/e56d5341056b98c6641d834b3f28c49e56fcc313.jpg',
					alt: 'Adidas Harden Vol. 9 Event',
					pullZone: 'wordpress',
					priority: false,
					width: 1200,
					quality: 85
				}
			]}
		/>
		<AdidasHardenV9EventGrid id="adidas-harden-v9-event-grid" />
		<TwoBlockImageContent
			id="two-block-image-content"
			image={{
				src: '/wp-content/uploads/2025/09/IMG_79720.jpg',
				alt: 'Content image',
				pullZone: 'wordpress',
				priority: false,
				width: 1200,
				quality: 85
			}}
			stats={{
				views: '2m+',
				likes: '500k'
			}}
			videos={[
				{
					src: 'https://times-10-video-offload.b-cdn.net/xCaseStudies%20_FamousLos32_09.02.25_v2.mp4',
					handle: 'famouslos32',
					followers: '1.5m'
				},
				{
					src: 'https://times-10-video-offload.b-cdn.net/xCaseStudies%20_Overtimekicks_09.02.25_v2.mp4',
					handle: 'overtimekicks',
					followers: '488k'
				},
				{
					src: 'https://times-10-video-offload.b-cdn.net/xCaseStudies%20_JeffreyBalbui_09.02.25_v2.mp4',
					handle: 'jeffreybalbui',
					followers: '283k'
				},
				{
					src: 'https://times-10-video-offload.b-cdn.net/xCaseStudies%20_daayylaan_09.02.25_v2.mp4',
					handle: 'daayylaan',
					followers: '240k'
				}
			]}
		/>
		<script>
			// Centralized Case Study Button Initialization
			// This script initializes all case study sections once, preventing conflicts when multiple case studies exist
			(function() {
				// Use media query to check if mobile (more reliable than window.innerWidth)
				const isMobile = window.matchMedia('(max-width: 1023px)').matches;
				if (!isMobile) return;

				// Track initialized sections to prevent duplicate initialization
				const initializedSections = new WeakSet();

				function initCaseStudyButtons() {
					// Find all case study sections with mobile layout
					const sections = document.querySelectorAll('section');
					
					sections.forEach((section) => {
						const mobileLayout = section.querySelector('.mobile-layout');
						if (!mobileLayout) return; // Skip if not a case study component

						// Skip if already initialized
						if (initializedSections.has(section)) return;
						initializedSections.add(section);

						const tabButtons = section.querySelectorAll('.tab-button');
						const tabContents = section.querySelectorAll('.tab-content');
						const contentContainer = section.querySelector('.tab-content-container');
						const contentCard = section.querySelector('.content-card');
						const tabNav = section.querySelector('.content-card > div:first-child');

						if (!contentCard || !contentContainer) return;

						// Function to expand the card
						const expandCard = () => {
							if (mobileLayout) {
								mobileLayout.classList.add('expanded');
							}
							if (contentCard) {
								contentCard.classList.add('expanded');
							}
							if (contentContainer) {
								contentContainer.classList.add('has-content');
							}
						};

						// Function to collapse the card
						const collapseCard = () => {
							if (mobileLayout) {
								mobileLayout.classList.remove('expanded');
							}
							if (contentCard) {
								contentCard.classList.remove('expanded');
							}
							if (contentContainer) {
								contentContainer.classList.remove('has-content');
							}
						};

						// Check if card is expanded
						const isExpanded = () => {
							return contentCard.classList.contains('expanded');
						};

						// Handle button clicks/touches (if tabs exist)
						if (tabButtons.length > 0) {
							tabButtons.forEach((button) => {
								// Handle both click and touchstart for better mobile support
								const handleInteraction = (e: Event) => {
									e.preventDefault();
									e.stopPropagation();
									const targetTab = button.getAttribute('data-tab');
									if (!targetTab) return;

									// Expand card if not already expanded
									if (!isExpanded()) {
										expandCard();
									}

									// Only update button states and content visibility if there are multiple tabs
									if (tabContents.length > 0) {
										// Update button states
										tabButtons.forEach((btn) => btn.classList.remove('active'));
										button.classList.add('active');

										// Update content visibility
										tabContents.forEach((content) => {
											content.classList.remove('active');
											if (content instanceof HTMLElement && content.id === `${targetTab}-content`) {
												content.classList.add('active');
											}
										});
									}
								};

								button.addEventListener('click', handleInteraction, { passive: false });
								button.addEventListener('touchstart', handleInteraction, { passive: false });
							});
						}

						// Handle clicks on the tab navigation area to expand/collapse
						if (tabNav) {
							const handleNavClick = (e: Event) => {
								// Don't toggle if clicking on a tab button (handled above)
								if (e.target instanceof HTMLElement && e.target.classList.contains('tab-button')) {
									return;
								}
								
								// Expand on first click
								if (!isExpanded()) {
									expandCard();
								}
							};

							tabNav.addEventListener('click', handleNavClick);
							tabNav.addEventListener('touchstart', handleNavClick);
						}

						// Check if there's a whatWeDid prop by checking if overview tab exists
						const hasWhatWeDid = section.querySelector('#overview-content') !== null;
						
						// If no tabs and no whatWeDid, make the card header area clickable to expand
						if (!tabButtons.length && !hasWhatWeDid) {
							const cardHeader = section.querySelector('.content-card > div:first-child');
							if (cardHeader instanceof HTMLElement) {
								cardHeader.style.cursor = 'pointer';
								const handleHeaderClick = () => {
									if (!isExpanded()) {
										expandCard();
									}
								};
								cardHeader.addEventListener('click', handleHeaderClick);
								cardHeader.addEventListener('touchstart', handleHeaderClick);
							}
						}

						// Add click handler to collapse when clicking outside content (on card background)
						const handleCardClick = (e: Event) => {
							// If clicking on the card itself (not children) and expanded, collapse
							if (e.target === contentCard && isExpanded()) {
								collapseCard();
							}
						};
						contentCard.addEventListener('click', handleCardClick);
						contentCard.addEventListener('touchstart', handleCardClick);
					});
				}

				// Run immediately if DOM is ready, otherwise wait for DOMContentLoaded
				if (document.readyState === 'loading') {
					document.addEventListener('DOMContentLoaded', initCaseStudyButtons);
				} else {
					initCaseStudyButtons();
				}
			})();
		</script>
		<section id="home-final" class="bg-[#f4f4f0] w-full max-w-screen mx-auto h-dvh flex items-end justify-center pb-[20vh] snap-start snap-always px-4 md:px-0">
			<img
				src={logoFinal}
				alt="times10 logo"
				class="w-[225px] max-h-full object-contain"
				loading="lazy"
				crossorigin="anonymous"
				width="225"
				height="56"
			/>
		</section>
		<HashScrollInit />
	</body>
</html>
