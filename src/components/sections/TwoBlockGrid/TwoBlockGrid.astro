---
import { LazyImage } from '../../LazyImage.tsx';
import { LazyVideo } from '../../LazyVideo.tsx';

export interface BlockContent {
	text?: string;
	image?: {
		src: string;
		alt: string;
		label?: string;
		pullZone?: string;
		priority?: boolean;
		width?: number;
		quality?: number;
	};
	video?: {
		src: string;
		label?: string;
		pullZone?: string;
		priority?: boolean;
	};
}

export interface Props {
	block1: {
		col1: BlockContent[]; // text, image, image
		col2: BlockContent[]; // vertical video, image
	};
	block2: {
		col1: BlockContent[]; // text, image, image
		col2: BlockContent[]; // vertical video
	};
	id?: string;
}

const { block1, block2, id } = Astro.props;
---

<section id={id} class="w-full h-dvh max-h-dvh p-2 md:p-4 lg:p-8 snap-start snap-always flex flex-col overflow-hidden box-border">
	<div class="w-full flex-1 min-h-0 grid grid-cols-1 lg:grid-cols-2 gap-2 md:gap-4 lg:gap-8">
		{/* Block 1 */}
		<div class="flex-1 min-h-0 grid grid-cols-1 lg:grid-cols-2 gap-2 md:gap-4 lg:gap-8">
			{/* Block 1 - Column 1: text, image, image */}
			<div class="flex flex-col gap-2 md:gap-4 lg:gap-8 min-h-0">
				{block1.col1.map((item, index) => (
					<div class={`relative overflow-hidden ${item.text ? 'flex-shrink-0' : index === 2 ? 'hidden lg:flex flex-1 min-h-0' : 'flex-1 min-h-0'}`}>
						{item.text ? (
							<div class="w-full h-full flex items-start justify-start">
								<span class="blk-title">
									{item.text}
								</span>
							</div>
						) : item.image ? (
							<>
								<LazyImage
									client:visible
									src={item.image.src}
									alt={item.image.alt}
									pullZone={item.image.pullZone}
									priority={item.image.priority || false}
									width={item.image.width || 1200}
									quality={item.image.quality || 85}
									className="w-full h-full object-cover"
								/>
								{item.image.label && (
									<div class="absolute bottom-0 left-0 px-3 md:px-4 lg:px-6 py-1.5 md:py-2 lg:py-3">
										<span class="text-white text-lg md:text-xl lg:text-2xl font-light lowercase tracking-wide">
											{item.image.label}
										</span>
									</div>
								)}
							</>
						) : null}
					</div>
				))}
			</div>

			{/* Block 1 - Column 2: vertical video, image */}
			<div class="flex flex-col gap-2 md:gap-4 lg:gap-8 min-h-0">
				{block1.col2.map((item, index) => (
					<div class={`relative overflow-hidden ${item.video ? 'flex-[2] min-h-0' : item.image ? index === 1 ? 'hidden lg:flex flex-1 min-h-0' : 'flex-1 min-h-0' : 'flex-shrink-0'}`}>
						{item.video ? (
							<>
								<LazyVideo
									client:load
									src={item.video.src}
									pullZone={item.video.pullZone}
									priority={item.video.priority !== undefined ? item.video.priority : true}
									autoPlay
									muted
									loop
									playsInline
									className="w-full h-full object-cover"
								/>
								{item.video.label && (
									<div class="absolute bottom-0 left-0 px-3 md:px-4 lg:px-6 py-1.5 md:py-2 lg:py-3">
										<span class="text-white text-lg md:text-xl lg:text-2xl font-light lowercase tracking-wide">
											{item.video.label}
										</span>
									</div>
								)}
							</>
						) : item.image ? (
							<>
								<LazyImage
									client:visible
									src={item.image.src}
									alt={item.image.alt}
									pullZone={item.image.pullZone}
									priority={item.image.priority || false}
									width={item.image.width || 1200}
									quality={item.image.quality || 85}
									className="w-full h-full object-cover"
								/>
								{item.image.label && (
									<div class="absolute bottom-0 left-0 px-3 md:px-4 lg:px-6 py-1.5 md:py-2 lg:py-3">
										<span class="text-white text-lg md:text-xl lg:text-2xl font-light lowercase tracking-wide">
											{item.image.label}
										</span>
									</div>
								)}
							</>
						) : null}
					</div>
				))}
			</div>
		</div>

		{/* Block 2 */}
		<div class="hidden lg:grid flex-1 min-h-0 grid-cols-1 lg:grid-cols-2 gap-2 md:gap-4 lg:gap-8">
			{/* Block 2 - Column 1: text, image, image */}
			<div class="flex flex-col gap-2 md:gap-4 lg:gap-8 min-h-0">
				{block2.col1.map((item, index) => (
					<div class={`relative overflow-hidden ${item.text ? 'flex-shrink-0' : 'flex-1 min-h-0'}`}>
						{item.text ? (
							<div class="w-full h-full flex items-start justify-start">
								<span class="blk-title">
									{item.text}
								</span>
							</div>
						) : item.image ? (
							<>
								<LazyImage
									client:visible
									src={item.image.src}
									alt={item.image.alt}
									pullZone={item.image.pullZone}
									priority={item.image.priority || false}
									width={item.image.width || 1200}
									quality={item.image.quality || 85}
									className="w-full h-full object-cover"
								/>
								{item.image.label && (
									<div class="absolute bottom-0 left-0 px-3 md:px-4 lg:px-6 py-1.5 md:py-2 lg:py-3">
										<span class="text-white text-lg md:text-xl lg:text-2xl font-light lowercase tracking-wide">
											{item.image.label}
										</span>
									</div>
								)}
							</>
						) : null}
					</div>
				))}
			</div>

			{/* Block 2 - Column 2: vertical video */}
			<div class="flex flex-col gap-2 md:gap-4 lg:gap-8 min-h-0">
				{block2.col2.map((item, index) => (
					<div class={`relative overflow-hidden ${item.video ? 'flex-1 min-h-0' : 'flex-shrink-0'}`}>
						{item.video ? (
							<>
								<LazyVideo
									client:load
									src={item.video.src}
									pullZone={item.video.pullZone}
									priority={item.video.priority !== undefined ? item.video.priority : true}
									autoPlay
									muted
									loop
									playsInline
									className="w-full h-full object-cover"
								/>
								{item.video.label && (
									<div class="absolute bottom-0 left-0 px-3 md:px-4 lg:px-6 py-1.5 md:py-2 lg:py-3">
										<span class="text-white text-lg md:text-xl lg:text-2xl font-light lowercase tracking-wide">
											{item.video.label}
										</span>
									</div>
								)}
							</>
						) : null}
					</div>
				))}
			</div>
		</div>
	</div>
</section>
