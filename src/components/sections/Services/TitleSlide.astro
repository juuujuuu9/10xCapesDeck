---
import { bunnyImage } from '../../../lib/bunny-cdn';

interface Props {
	backgroundImage: string;
	backgroundImageMobile?: string;
	textParts: Array<{ text: string; color: string }>;
	overlayOpacity?: number;
	id?: string;
}

const { backgroundImage, backgroundImageMobile, textParts, overlayOpacity = 75, id } = Astro.props;

// RULE-021: WordPress URL auto-conversion to Bunny CDN
// RULE-014: WebP format for optimal compression
const pullZone = backgroundImage?.startsWith('/wp-content/') ? 'wordpress' : 'storage';
const processedBg = bunnyImage(backgroundImage, { pullZone, width: 1920, quality: 85 });
const processedMobileBg = backgroundImageMobile 
	? bunnyImage(backgroundImageMobile, { pullZone: backgroundImageMobile.startsWith('/wp-content/') ? 'wordpress' : 'storage', width: 1200, quality: 85 })
	: processedBg;
const mobileBg = processedMobileBg;
---

<section 
	id={id}
	class="title-slide-responsive relative w-full max-w-screen mx-auto h-dvh flex items-center justify-center snap-start snap-always overflow-hidden bg-cover bg-center bg-no-repeat px-4 md:px-0"
	style={`--bg-mobile: url('${mobileBg}'); --bg-desktop: url('${processedBg}');`}
>
	<style>
		.title-slide-responsive {
			background-image: var(--bg-mobile);
		}
		@media (min-width: 768px) {
			.title-slide-responsive {
				background-image: var(--bg-desktop);
			}
		}
	</style>
	<!-- Black overlay -->
	<div class="absolute inset-0" style={`background: linear-gradient(rgba(0,0,0,0.75),rgba(0,0,0,0.75));`}></div>
	<!-- Text content -->
	<div class="relative z-10 text-center">
		<h2 class="text-[2rem] md:text-[3.5rem] lowercase font-[600]">
			{textParts.map((part, index) => (
				<span 
					class={index > 0 ? 'ml-1' : ''}
					style={`color: ${part.color};`}
				>
					{part.text}
				</span>
			))}
		</h2>
	</div>
</section>
